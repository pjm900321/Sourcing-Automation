# 쿠팡 키워드 로켓배송 비율 분석기

이 프로젝트는 `input/` 폴더의 엑셀 파일에서 `키워드` 컬럼을 읽어, 쿠팡 검색 결과 상위 10개 **광고 제외** 상품 중 로켓배송 배지의 비율을 계산합니다. 결과는 `output/results.xlsx`에 저장되며, PASS 결과만 모은 시트도 함께 생성됩니다.

## 폴더 구조

```
Sourcing-Automation/
├─ input/        # 키워드 엑셀 파일 저장
├─ output/       # 결과 엑셀 파일 저장
├─ src/
│  └─ main.py
├─ install.bat   # 윈도우 설치(셋업) 배치
├─ run.bat       # 윈도우 실행 배치
├─ requirements.txt
└─ README_ko.md
```

## 사전 준비

- Windows 10/11
- Python 3.10 이상
- Google Chrome 브라우저 설치 필요 (디버깅 모드로 실행되는 실제 Chrome 사용)

## 1) 설치 (더블 클릭)

1. `install.bat`을 **더블 클릭**합니다.
2. 가상환경 생성 후 필요한 라이브러리가 자동으로 설치됩니다.
3. 설치가 끝나면 창이 자동으로 멈추며, 아무 키나 누르면 종료됩니다.

## 2) 입력 파일 준비

1. `input/` 폴더에 `.xlsx` 파일을 넣습니다.
2. 반드시 `키워드`라는 컬럼이 있어야 합니다.

## 3) 실행 (더블 클릭)

1. `run.bat`을 **더블 클릭**합니다.
2. 자동으로 분석이 시작됩니다.
3. 완료 후 `output/results.xlsx`가 생성됩니다.

## 결과 파일 설명

- `main` 시트: 모든 키워드 결과
- `pass_only` 시트: PASS 판정만 모음

컬럼 의미는 다음과 같습니다.

- `상위10개중개수`: 광고 제외 상위 10개 결과 중 실제 집계된 개수
- `로켓배송개수`: 로켓배송 배지 수
- `로켓비율`: 로켓배송개수 / 상위10개중개수
- `판정`: 로켓배송 5개 이하면 PASS, 6개 이상이면 FAIL
- `오류`: 실패 시 에러 메시지

## 동작 방식

- 각 키워드마다 **새 브라우저 컨텍스트(로그인 없는 상태)**로 검색합니다.
- 광고 배지(`광고`)가 있는 상품은 제외합니다.
- 상위 10개 유기 결과만 집계합니다.
- 중간 결과를 즉시 저장해 **중단 후 재실행 시 이어서 진행**합니다.
- 키워드별로 최대 3회까지 재시도합니다.

## 옵션

기본 실행은 `input/` 폴더 내 첫 번째 `.xlsx` 파일을 사용합니다.

```
python src/main.py --input input/파일명.xlsx
```

테스트 모드는 첫 번째 키워드만 실행하며, 디버그 파일을 저장합니다.

```
python src/main.py --test
```

- `output/debug.html`: 검색 결과 HTML 저장
- `output/debug.png`: 검색 결과 스크린샷 저장

## 주의 사항

- 쿠팡 UI 구조가 변경되면 배지 판별 로직이 달라질 수 있습니다.
- 보안 프로그램이 Chrome 실행을 막을 수 있습니다.
